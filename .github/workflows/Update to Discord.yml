name: Upload Haloarmory to Discord

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "main" branch
  push:

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch: 
  
jobs:
  zip-n-push:
    name: Zip and Push
    runs-on: ubuntu-latest
    steps:
      - name: Logging
        #run: |
        # echo "${{toJSON(github.event)}}"
        run: |
          echo "Last commit message: ${{ github.event.commits[0].message }}"
          echo "${{ toJSON(github.event) }}"
      - name: Checkout Repository
        uses: actions/checkout@master
      - name: Zip Folder
        run: |
          cd ../
          cp -vr HaloArmory-InDev haloarmory-v1
          rm -rf HaloArmory-InDev/Haloarmory.zip
          zip -r HaloArmory-InDev/Haloarmory.zip ./haloarmory-v1 -x "haloarmory-v1/.git/*" "haloarmory-v1/.github/*" "haloarmory-v1/README.md"
      - name: Send Discord Update
        uses: tsickert/discord-webhook@v5.3.0
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK }}
          embed-title: "Foo"
          embed-description: "${{ github.event.commits[0].message }}"
          embed-color: 3104415
          filename: "./Haloarmory.zip"
